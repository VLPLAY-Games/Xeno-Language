name: Multi-ESP32 Compile Test
on: [push, pull_request]

jobs:
  compile-test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        board: 
          - esp32:esp32:esp32
          - esp32:esp32:esp32c3
          - esp32:esp32:esp32c6
          - esp32:esp32:esp32h2
          - esp32:esp32:p4
          - esp32:esp32:esp32s2
          - esp32:esp32:esp32s3
    
    steps:
    - uses: actions/checkout@v4
    - uses: arduino/setup-arduino-cli@v1
    
    - name: Add ESP32 board support
      run: |
        arduino-cli config add board_manager.additional_urls https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json
        arduino-cli core update-index
        arduino-cli core install esp32:esp32
    
    - name: Compile for ${{ matrix.board }}
      run: |
        echo "Compiling for ${{ matrix.board }}"
        arduino-cli compile --fqbn ${{ matrix.board }} --build-library .